# 30 June, 2016

## fetch

今天遇到一个fetch方面的问题：一个ajax请求在到达业务层之前先做了对session的判断，如果没有相应的cookie就直接deny返回了。用fetch一直错误返回，查了请求才知道header中没有cookie。翻了文档发现[fetch文档](https://github.com/github/fetch)里就有明确的说明：

> Sending cookies

> To automatically send cookies for the current domain, the credentials option must be provided:

> 
```js
fetch('/users', {
  credentials: 'same-origin'
})
```
> This option makes fetch behave similar to XMLHttpRequest with regards to cookies. Otherwise, cookies won't get sent, resulting in these requests not preserving the authentication session.

> Use the include value to send cookies in a cross-origin resource sharing (CORS) request.

>
```js
fetch('https://example.com:1234/users', {
  credentials: 'include'
})
```

`credentials`属性就是来控制cookie的，默认不发送。它有两个值：

- `same-origin` 同源才发送cookie
- `include` 不同源也会发送cookie

## Cross-origin resource sharing(CORS)


